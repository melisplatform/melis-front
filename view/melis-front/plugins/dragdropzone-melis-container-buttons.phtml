<div class="column-icons">

    <?php
    foreach ($this->dndLayouts as $k => $layout) {

        // dump($layout);
        if (!empty($layout['template']) && (!empty($layout['html-button-icon'])))
            echo '<div data-dnd-id="' . $this->dndId . '" data-dnd-tpl="' . $k . '">' . $layout['html-button-icon'] . '</div>';
    }

    ?>
    <!-- <button class="column-icon top-1-col-w-bottom-1-3-center">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row justify-content-center">
                <div class="icon-col-bg icon-col-4 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon top-1-col-w-center-1-3-center-w-bottom-1-col">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row justify-content-center">
                <div class="icon-col-bg icon-col-4 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon whole-1-col">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon half-1-col-left-w-right-2-col">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-6 icon-col-bg bg-white">
                </div>
                <div class="icon-col-6">
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                </div>
            </div>
        </div>
    </button>
    <button class="column-icon left-2-col-w-right-1-col">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-6">
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                </div>
                <div class="icon-col-bg icon-col-6 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon four-col-equal-square">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-6 bg-white"></div>
                <div class="icon-col-bg icon-col-6 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-6 bg-white"></div>
                <div class="icon-col-bg icon-col-6 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon half-1-col-left-w-right-3-col">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-6 bg-white"></div>
                <div class="icon-col-bg icon-col-6">
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                </div>
            </div>
        </div>
    </button>
    <button class="column-icon left-3-col-w-half-1-col-right">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-6">
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                </div>
                <div class="icon-col-bg icon-col-6 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon top-1-3-col-center">
        <div class="icon-container">
            <div class="icon-row justify-content-center">
                <div class="icon-col-bg icon-col-4 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12"></div>
            </div>
        </div>
    </button>
    <button class="column-icon top-1-3-col-center-w-bottom-1-col">
        <div class="icon-container">
            <div class="icon-row justify-content-center">
                <div class="icon-col-bg icon-col-4 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon half-col-equal">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-6 bg-white"></div>
                <div class="icon-col-bg icon-col-6 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon three-col-equal">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-4 bg-white"></div>
                <div class="icon-col-bg icon-col-4 bg-white"></div>
                <div class="icon-col-bg icon-col-4 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon four-col-equal">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col bg-white"></div>
                <div class="icon-col-bg icon-col bg-white"></div>
                <div class="icon-col-bg icon-col bg-white"></div>
                <div class="icon-col-bg icon-col bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon half-col-top-bottom">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row justify-content-center">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon three-col-equal-top-bottom">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon four-col-equal-top-bottom">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
        </div>
    </button> -->
</div>

<script type="application/javascript">
    setTimeout(() => {
        $(function() {
            $(".dnd-layout-buttons div[data-dnd-tpl]").off().on("click", function() {
                // initialize dynamic dragndrop
                melisDynamicDragnDrop.init();

                let dndId = $(this).data("dndId");
                let dndTpl = $(this).data("dndTpl");
                let pageId = <?= $this->pageId ?>;
                let melisSite = "<?= $_GET['melisSite'] ?>";

                $.get("/dnd-layout", {
                    pageId,
                    dndId,
                    dndTpl,
                    melisSite
                }).done((res) => {
                    if (res.success) {

                        $(".melis-dragdropzone-container[data-plugin-id='" + dndId + "']").replaceWith(res.html);

                        if (res.pluginsInitFiles) {

                            setTimeout(() => {
                                $.each(res.pluginsInitFiles, (i, v) => {
                                    // reinitialize plugins
                                    // melisPluginEdition.processPluginResources(v, i);
                                });

                                melisPluginEdition.moveResponsiveClass();
                                melisPluginEdition.pluginDetector();
                                melisPluginEdition.initResizable();

                                melisPluginEdition.sendDragnDropList(dndId, pageId);

                                // TODO 
                                melistagHTML_init();

                            }, 1000)
                        }

                    }
                })
            })
        })
    }, 1000)
</script>