<div class="column-icons">

    <?php
    foreach ($this->dndLayouts as $k => $layout) {

        // dump($layout);
        if (!empty($layout['template']) && (!empty($layout['html-button-icon'])))
            echo '<div data-dnd-id="' . $this->dndId . '" data-dnd-tpl="' . $k . '" data-page-id="' . $this->pageId . '" data-melis-site="' . $_GET['melisSite'] . '">' . $layout['html-button-icon'] . '</div>';
    }

    ?>
    <!-- <button class="column-icon top-1-col-w-bottom-1-3-center">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row justify-content-center">
                <div class="icon-col-bg icon-col-4 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon top-1-col-w-center-1-3-center-w-bottom-1-col">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row justify-content-center">
                <div class="icon-col-bg icon-col-4 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon whole-1-col">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon half-1-col-left-w-right-2-col">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-6 icon-col-bg bg-white">
                </div>
                <div class="icon-col-6">
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                </div>
            </div>
        </div>
    </button>
    <button class="column-icon left-2-col-w-right-1-col">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-6">
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                </div>
                <div class="icon-col-bg icon-col-6 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon four-col-equal-square">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-6 bg-white"></div>
                <div class="icon-col-bg icon-col-6 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-6 bg-white"></div>
                <div class="icon-col-bg icon-col-6 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon half-1-col-left-w-right-3-col">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-6 bg-white"></div>
                <div class="icon-col-bg icon-col-6">
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                </div>
            </div>
        </div>
    </button>
    <button class="column-icon left-3-col-w-half-1-col-right">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-6">
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                    <div class="icon-row">
                        <div class="icon-col-bg icon-col-12 bg-white"></div>
                    </div>
                </div>
                <div class="icon-col-bg icon-col-6 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon top-1-3-col-center">
        <div class="icon-container">
            <div class="icon-row justify-content-center">
                <div class="icon-col-bg icon-col-4 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12"></div>
            </div>
        </div>
    </button>
    <button class="column-icon top-1-3-col-center-w-bottom-1-col">
        <div class="icon-container">
            <div class="icon-row justify-content-center">
                <div class="icon-col-bg icon-col-4 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon half-col-equal">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-6 bg-white"></div>
                <div class="icon-col-bg icon-col-6 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon three-col-equal">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-4 bg-white"></div>
                <div class="icon-col-bg icon-col-4 bg-white"></div>
                <div class="icon-col-bg icon-col-4 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon four-col-equal">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col bg-white"></div>
                <div class="icon-col-bg icon-col bg-white"></div>
                <div class="icon-col-bg icon-col bg-white"></div>
                <div class="icon-col-bg icon-col bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon half-col-top-bottom">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row justify-content-center">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon three-col-equal-top-bottom">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
        </div>
    </button>
    <button class="column-icon four-col-equal-top-bottom">
        <div class="icon-container">
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
            <div class="icon-row">
                <div class="icon-col-bg icon-col-12 bg-white"></div>
            </div>
        </div>
    </button> -->
</div>


<script>
    // setTimeout(() => {
    //     $(".dnd-layout-buttons div[data-dnd-tpl]").off().click(function() {
    //         let dndId = $(this).data("dndId");
    //         let dndTpl = $(this).data("dndTpl");
    //         let pageId = $(this).data("pageId");
    //         let melisSite = $(this).data("melisSite");
    //         var tempLoader = '<div id="loader" class="overlay-loader"><img class="loader-icon spinning-cog" src="/MelisCore/assets/images/cog12.svg" data-cog="cog12"></div>';

    //         $(this).closest(".melis-dragdropzone-container").prepend(tempLoader);

    //         let dndContainer = $(this).closest(".melis-dragdropzone-container");

    //         let dndLayout = dndContainer.find(".melis-dragdropzone");
    //         let dndCtr = dndLayout.length;

    //         console.log({
    //             dndCtr
    //         });

    //         $.get("/dnd-layout", {
    //             pageId,
    //             dndId,
    //             dndTpl,
    //             melisSite
    //         }).done((res) => {
    //             if (res.success) {

    //                 dndContainer.find("#loader").remove();

    //                 let newLayout = $(res.html);
    //                 let newLayoutDnd = newLayout.find(".melis-dragdropzone");
    //                 let newLayoutDndCtr = newLayoutDnd.length;

    //                 console.log({
    //                     newLayoutDndCtr
    //                 })

    //                 if (dndCtr != newLayoutDndCtr) {

    //                     if (dndCtr == 1) {
    //                         let dndContent = dndContainer.find(".melis-dragdropzone");

    //                         $.each(dndContent.children(), (i, v) => {
    //                             // filter dnd with contents
    //                             if ($(v).text().trim() !== "") {
    //                                 // move and append to new dnd layout
    //                                 $(v).appendTo(newLayout.find(".melis-dragdropzone:first"));
    //                             }
    //                         });

    //                         // replacing new layout
    //                         $("body .melis-dragdropzone-container[data-plugin-id='" + dndId + "']").replaceWith(newLayout);

    //                     } else {

    //                         // comparing dnds to the new dnd layout
    //                         $.each(dndLayout, (i, v) => {

    //                             // checking if the plugin id not exist in the new layout
    //                             let pluginExist = newLayout.find("div.melis-dragdropzone[data-plugin-id='" + $(v).data("pluginId") + "']");
    //                             // all plugin no exist in the new layout will append to the last dnd in the new layout
    //                             if (!pluginExist.length) {
    //                                 let dndContents = $(v).children();

    //                                 $.each(dndContents, (di, dv) => {
    //                                     // filter dnd with contents
    //                                     if ($(dv).text().trim() !== "") {
    //                                         // move and append to new dnd layout
    //                                         $(dv).appendTo(newLayout.find(".melis-dragdropzone:last"));
    //                                     }
    //                                 });
    //                             }
    //                         });

    //                         // replacing new layout
    //                         $("body .melis-dragdropzone-container[data-plugin-id='" + dndId + "']").replaceWith(newLayout);
    //                     }
    //                 } else
    //                     console.log('just reload');



    //                 // if (res.pluginsInitFiles) {

    //                 //     setTimeout(() => {
    //                 //         $.each(res.pluginsInitFiles, (i, v) => {
    //                 //             // reinitialize plugins
    //                 //             // melisPluginEdition.processPluginResources(v, i);
    //                 //         });

    //                 melisPluginEdition.moveResponsiveClass();
    //                 melisPluginEdition.pluginDetector();
    //                 melisPluginEdition.initResizable();

    //                 melisPluginEdition.sendDragnDropList(dndId, pageId);

    //                 //         // TODO 
    //                 //         melistagHTML_init();

    //                 //     }, 1000)
    //                 // }

    //             }
    //         }).always(() => {
    //             $(this).find("#loader").remove();
    //         });
    //     });
    // }, 5000)
</script>