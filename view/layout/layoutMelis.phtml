<?php echo $this->content; ?>
<!-- Rendered with Melis CMS V2 - <?= date("Y-m-d H:i:s"); ?> -->

<link href="https://fonts.googleapis.com/css?family=Lato:400,700,900" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="/MelisCore/assets/components/library/icons/fontawesome/assets/css/font-awesome.min.css">

<?php 
    foreach ($this->assets['css']as $css)
    {
        echo '<link href="' . $css . '" media="screen" rel="stylesheet" type="text/css">' . "\n";
    }
?>

<script type="text/javascript">

    var jQueryChecker = null;
    var melisActivePageId = window.parent.$("#"+parent.activeTabId).find("iframe").data("iframe-id");
    
    <?php
    /**
     * This JS function will check if JQuery is already added in the template
     * currently being edited as adding a new one would destroy instances already created.
     * If no JQuery, then we add it.
     */
    ?>
    function loadScript(url, callback) {
        var body = document.getElementsByTagName('body')[0];
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = url;
        script.onreadystatechange = callback;
        script.onload = callback;
        body.appendChild(script);
    }
    
    function loadLayoutScripts() {
        var jQueryChecker = setTimeout(function(){
            if(window.jQuery !== undefined) {
                loadScript("/MelisCore/js/library/tinymce/tinymce.min.js");
                loadScript("/MelisCore/js/tinyMCE/tinymce_cleaner.js");
                loadScript("/MelisCore/js/tinyMCE/melis_tinymce.js");
                loadScript("/MelisFront/js/melisfront_tinycme.js");
                loadScript("/MelisCms/js/tools/findpage.tool.js");
                loadScript("/MelisCms/js/plugins/plugins.edition.js");

				<?php 
    				foreach ($this->assets['js']as $js)
    				{
    				    echo 'loadScript("'.$js.'");' . "\n";
    				}
				?>
                
                clearTimeout(jQueryChecker);
            }
        }, 300);
    } 


    (function() {
        
        if ('undefined' == typeof window.jQuery) {
            loadScript("/MelisCore/assets/components/library/jquery/jquery.min.js?v=v1.2.3");
        }     

        // raw js disable all links
        var anchors = document.getElementsByTagName('a');
        for(i=0, len=anchors.length; i<len; i++) {
            anchors[i].addEventListener('click', function(e){e.preventDefault();});
        }
        // jQuery checker
        var checkjQueryExists = setInterval(function() {
        	if(window.jQuery !== undefined) {
        	 	$('form').submit(false); 
             	loadLayoutScripts();
             	clearInterval(checkjQueryExists);
            }
        }, 500);
    })();
</script>



<script type="text/javascript" src="/melis/MelisCore/Language/getTranslations"></script>

<?php
    echo $this->pluginsMenu;
?>